---

---

<div class='flex flex-col space-y-24 rounded-2xl lg:max-h-[600px] lg:flex-row lg:space-y-0'>
    <div class='flex w-full flex-col lg:w-2/3 lg:rounded-l-2xl lg:bg-brand-gray lg:px-24 lg:py-24'>
        <h3 class='mb-4 text-xl font-bold capitalize leading-[30px] text-white lg:text-black'>
            what can we do for you?
        </h3>

        <p class='mb-8 text-sm text-white lg:text-black'>
            Fill out the form below to get in touch with our experienced team of contractors,
            painters, architects and more.
        </p>
        <form
            class='lg: mb-4 flex flex-col space-y-6 lg:grid lg:grid-cols-2 lg:gap-6 lg:space-y-0'
            id='contactForm'
            novalidate
        >
            <div class='relative'>
                <input placeholder=' ' id='name' type='text' class='peer w-full' />
                <label
                    for='name'
                    class='-translate-y-9 peer-placeholder-shown:-translate-y-1 peer-placeholder-shown:scale-100 peer-focus:-translate-y-9 peer-focus:scale-75 rtl:peer-focus:left-auto rtl:peer-focus:translate-x-2'
                    >Name</label
                >
                <div id='nameError' class='text-sm text-red-500'></div>
            </div>
            <div class='relative'>
                <input placeholder=' ' id='email' type='email' class='peer w-full' />
                <label
                    for='email'
                    class='-translate-y-9 peer-placeholder-shown:-translate-y-1 peer-placeholder-shown:scale-100 peer-focus:-translate-y-9 peer-focus:scale-75 rtl:peer-focus:left-auto rtl:peer-focus:translate-x-2'
                    >Email</label
                >
                <div id='emailError' class='text-sm text-red-500'></div>
            </div>
            <div class='relative'>
                <select id='reason' class='select-input peer w-full cursor-pointer'>
                    <option value='' disabled selected></option>
                    <option value='residential'>Residential</option>
                    <option value='commercial'>Commercial</option>
                </select>
                <button
                    aria-label='DropDown Button'
                    class='pointer-events-none absolute right-3 top-2 z-10 h-4 w-4 items-center justify-center rounded-full bg-black p-3 disabled:opacity-20 lg:top-2 lg:flex'
                >
                </button>
                <span
                    class='arrow-icon icon-[simple-line-icons--arrow-down] pointer-events-none absolute right-[18px] top-[14.5px] z-10 h-3 w-3 transform text-white duration-300 peer-focus:rotate-180 lg:right-[18px] lg:top-[14.5px]'
                ></span>
                <label
                    for='reason'
                    class='label-select pointer-events-none -translate-y-[5px] scale-100 peer-focus:-translate-y-9 peer-focus:scale-75 rtl:peer-focus:left-auto rtl:peer-focus:translate-x-2'
                    >Reason For Contacting</label
                >
                <div id='reasonError' class='text-sm text-red-500'></div>
            </div>
            <div class='relative'>
                <input placeholder=' ' type='tel' id='phone' name='phone' class='peer w-full' />
                <label
                    for='phone'
                    class='-translate-y-9 peer-placeholder-shown:-translate-y-1 peer-placeholder-shown:scale-100 peer-focus:-translate-y-9 peer-focus:scale-75 rtl:peer-focus:left-auto rtl:peer-focus:translate-x-2'
                    >Phone</label
                >
                <div id='phoneError' class='text-sm text-red-500'></div>
            </div>
            <div class='relative col-span-2'>
                <textarea id='message' placeholder=' ' class='peer w-full'></textarea>
                <label
                    for='message'
                    class='-translate-y-9 peer-placeholder-shown:-translate-y-1 peer-placeholder-shown:scale-100 peer-focus:-translate-y-9 peer-focus:scale-75 rtl:peer-focus:left-auto rtl:peer-focus:translate-x-2'
                    >Message</label
                >
                <div id='messageError' class='text-sm text-red-500'></div>
            </div>
            <button type='submit' class='primary-btn w-full lg:w-[132px]'>
                <span class='font-medium leading-normal tracking-tight text-black'> Submit </span>
            </button>
        </form>
    </div>
    <div
        class='hidden w-1/3 flex-col items-center justify-center rounded-r-2xl bg-brand-green-primary lg:flex'
    >
        <div class='flex h-full flex-col justify-center space-y-4 text-white'>
            <h3 class='mb-4 text-xl font-bold leading-[30px] text-white'>Contact Information</h3>

            <div class='mb-4 flex items-center space-x-6'>
                <a
                    href='https://maps.google.com/?q=0000+Design+Drive+Denver+Colorado'
                    class=`flex items-center justify-center p-1.5 h-8 w-8 rounded-full bg-white hover:opacity-50`
                    aria-label='Construx Location Link'
                >
                    <span class='icon-[ep--location] h-6 w-6 text-black'></span>
                </a>
                <div class='flex flex-col space-y-1'>
                    <span class='font-bold leading-[30px] text-white'>Cnstrx Office</span>
                    <span class='text-sm text-white'>000 Parkway Blg. 16</span>
                    <span class='text-sm text-white'>Colorado Springs, CO</span>
                </div>
            </div>
            <div class='mb-4 flex items-center space-x-6'>
                <a
                    href=`tel:000000000`
                    class=`flex items-center justify-center h-8 w-8 p-1.5 rounded-full bg-white hover:opacity-50`
                    aria-label='Construx Location Link'
                >
                    <span class='icon-[mage--phone] h-6 w-6 text-black'></span>
                </a>
                <div class='flex flex-col space-y-1'>
                    <span class='font-bold leading-[30px]'>Call Us</span>
                    <span class='text-sm'>000-000-0000</span>
                </div>
            </div>
            <div class='mb-4 flex items-center space-x-6'>
                <a
                    href='mailto:mail@construx.construction'
                    class=`flex items-center justify-center p-1.5 h-8 w-8 rounded-full bg-white hover:opacity-50`
                    aria-label='Construx Location Link'
                >
                    <span class='icon-[eva--email-outline] h-6 w-6 text-black'></span>
                </a>
                <div class='flex flex-col space-y-1'>
                    <span class='font-bold leading-[30px]'>Mail Us</span>
                    <span class='text-sm'>mail@construx.construction</span>
                </div>
            </div>
            <div class='mb-4 flex items-center space-x-6'>
                <a
                    href='https://maps.google.com/?q=0000+Design+Drive+Denver+Colorado'
                    class=`flex items-center justify-center p-1.5 h-8 w-8 rounded-full bg-white hover:opacity-50`
                    aria-label='Construx Location Link'
                >
                    <span class='icon-[ri--building-4-line] h-6 w-6 text-black'></span>
                </a>
                <div class='flex flex-col space-y-1'>
                    <span class='font-bold leading-[30px]'>Opening Hours</span>
                    <span class='text-sm'>Mon-Fri: 8AM - 5PM</span>
                    <span class='text-sm'>Sat-Sun: CLOSED</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    import { z } from 'astro/zod';
    import isMobilePhone from 'validator/es/lib/isMobilePhone';

    const form: HTMLFormElement = document.getElementById('contactForm') as HTMLFormElement;

    const name: HTMLInputElement = document.getElementById('name') as HTMLInputElement;
    const nameError: HTMLDivElement = document.getElementById('nameError') as HTMLDivElement;

    const email: HTMLInputElement = document.getElementById('email') as HTMLInputElement;
    const emailError: HTMLDivElement = document.getElementById('emailError') as HTMLDivElement;

    const reason: HTMLSelectElement = document.getElementById('reason') as HTMLSelectElement;
    const reasonError: HTMLDivElement = document.getElementById('reasonError') as HTMLDivElement;

    const phone: HTMLInputElement = document.getElementById('phone') as HTMLInputElement;
    const phoneError: HTMLDivElement = document.getElementById('phoneError') as HTMLDivElement;

    const message: HTMLTextAreaElement = document.getElementById('message') as HTMLTextAreaElement;
    const messageError: HTMLDivElement = document.getElementById('messageError') as HTMLDivElement;

    const ContactFormSchema = z.object({
        name: z.string().min(1, 'Please enter your name'),
        email: z.string().email('Please enter a valid email address'),
        reason: z.string().min(1, 'Please select your reason for contacting'),
        phone: z.string().refine((val) => isMobilePhone(val), {
            message: 'Please enter a valid phone number',
        }),
        message: z.string().min(1, 'Please eneter a message'),
    });

    document.addEventListener('DOMContentLoaded', () => {
        const selectInputs = document.querySelectorAll<HTMLSelectElement>('.select-input');
        const labelSelect = document.querySelector<HTMLLabelElement>('.label-select');

        selectInputs.forEach((select) => {
            select.addEventListener('change', (event) => {
                const target = event.target as HTMLSelectElement;
                if (target.value) {
                    labelSelect?.classList.remove('-translate-y-[5px]');
                    labelSelect?.classList.add('-translate-y-9');
                    labelSelect?.classList.remove('scale-100');
                    labelSelect?.classList.add('scale-75');
                } else {
                    labelSelect?.classList.add('-translate-y-[5px]');
                    labelSelect?.classList.remove('-translate-y-9');
                    labelSelect?.classList.add('scale-100');
                    labelSelect?.classList.remove('scale-75');
                }
            });
        });
    });

    // Function to handle field errors
    function handleFieldError(
        field: HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement,
        errorElement: HTMLElement,
        errors: string[] | undefined,
    ): void {
        if (errors) {
            errorElement.textContent = errors.join(', ');
            field?.classList.add('border', 'border-red-500');
        } else {
            errorElement.textContent = '';
            field?.classList.remove('border', 'border-red-500');
        }
    }

    // Function to handle form submission
    function onFormSubmit(e: Event): void {
        e.preventDefault();

        const formData = {
            name: name?.value,
            email: email?.value,
            reason: reason?.value,
            phone: phone?.value,
            message: message?.value,
        };

        const validationResults = ContactFormSchema.safeParse(formData);

        if (!validationResults.success) {
            const formattedFormErrors = validationResults.error.format();

            handleFieldError(name, nameError, formattedFormErrors.name?._errors);
            handleFieldError(email, emailError, formattedFormErrors.email?._errors);
            handleFieldError(reason, reasonError, formattedFormErrors.reason?._errors);
            handleFieldError(phone, phoneError, formattedFormErrors.phone?._errors);
            handleFieldError(message, messageError, formattedFormErrors.message?._errors);

            console.log(formattedFormErrors);
        } else {
            // Clear all fields if the form is valid
            [name, email, reason, phone, message].forEach((field) => {
                field?.classList.remove('border', 'border-red-500');
            });

            [nameError, emailError, reasonError, phoneError, messageError].forEach(
                (errorElement) => {
                    errorElement.textContent = '';
                },
            );
        }
    }

    form?.addEventListener('submit', onFormSubmit);
</script>
